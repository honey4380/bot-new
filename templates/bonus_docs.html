<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bonus API DokÃ¼mantasyonu</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/bonus_docs.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Bonus API DokÃ¼mantasyonu</h1>
            <p>Bonus ekleme ve kontrol iÅŸlemleri iÃ§in API dokÃ¼mantasyonu</p>
        </header>

        <section id="endpoint">
            <h2>Endpoint: /api/checkBonusEligibility</h2>
            <div class="endpoint-details">
                <p>Method: POST</p>
                <p>Authentication: Bearer Token Required</p>
            </div>
        </section>

        <section id="request-format">
            <h2>Ä°stek FormatÄ± ve DetaylÄ± Ã–rnek</h2>
            <div class="example-wrapper">
                <pre><code class="language-json">
{
    "bonuses": [
        {
            "id": 4478,  // Bonus kampanya ID'si
            "value": {
                // calculationType: Bonus hesaplama tipi (Zorunlu)
                // - fixed: Sabit miktar bonus (Ã¶rn: 250 TL, 50 freespin)
                // - percentage: YÃ¼zdelik bonus (Ã¶rn: %100, %20)
                "calculationType": "percentage",
                
                // amountCalculation: Bonus miktarÄ± hesaplama yÃ¶ntemi
                // - lastDeposit: Son yatÄ±rÄ±m Ã¼zerinden
                // - yesterdayTotalDeposit: DÃ¼nkÃ¼ tÃ¼m yatÄ±rÄ±mlarÄ±n toplamÄ± Ã¼zerinden (YENÄ°)
                // - loss: KayÄ±p Ã¼zerinden (calculationDate ve minDiff gerekli)
                // - profit: Kar Ã¼zerinden (calculationDate ve minDiff gerekli)
                "amountCalculation": "loss",
                
                // calculationDate: Kar/Zarar hesaplama tarihi (UTC)
                // loss veya profit iÃ§in zorunlu
                // Format: YYYY-MM-DDTHH:mm:ss
                "calculationDate": "2025-02-21T22:05:00",
                
                // minDiff: Minimum kar/zarar miktarÄ±
                // loss veya profit iÃ§in zorunlu
                "minDiff": 20,
                
                // maxDiff: Maksimum kar/zarar miktarÄ± 
                // Opsiyonel, null = limit yok
                "maxDiff": null,
                
                // amount: Bonus miktar aralÄ±klarÄ±
                // Kademeli bonus iÃ§in birden fazla aralÄ±k tanÄ±mlanabilir
                "amount": [
                    {
                        "min": 20,     // Min yatÄ±rÄ±m/kar/zarar miktarÄ±
                        "max": 9999,   // Max yatÄ±rÄ±m/kar/zarar miktarÄ±
                        "percentage": 20 // fixed tipinde: Direkt bonus miktarÄ±
                                       // percentage tipinde: YÃ¼zde deÄŸeri
                    },
                    {"min": 10000, "max": 19999, "percentage": 25},
                    {"min": 20000, "max": null, "percentage": 30} // max: null = Ã¼st limit yok
                ],
                
                // max: Maksimum bonus limiti (percentage tipinde zorunlu)
                // 1) Tek deÄŸer: Sabit limit
                // "max": 2000
                // 2) GÃ¼nlÃ¼k farklÄ± limitler: [Pzt,Sal,Ã‡ar,Per,Cum,Cmt,Paz]
                "max": [600, 300, 300, 300, 300, 300, 300]
            },
            "usage": {
                // maxUses: Maksimum kullanÄ±m sayÄ±sÄ± (Zorunlu)
                // -1: SÄ±nÄ±rsÄ±z kullanÄ±m
                // 1: Tek kullanÄ±mlÄ±k
                // >1: Belirtilen sayÄ± kadar
                "maxUses": -1,
                
                // resetDayCount: KullanÄ±m hakkÄ± sÄ±fÄ±rlama periyodu
                // 1) SayÄ±: GÃ¼n bazÄ±nda (Ã¶rn: 1 = her gÃ¼n sÄ±fÄ±rla)
                // 2) "activeDays": Aktif gÃ¼nlerde sÄ±fÄ±rla
                "resetDayCount": "activeDays",
                
                // resetHour: SÄ±fÄ±rlama saati (0-23)
                // VarsayÄ±lan: 0 (gece yarÄ±sÄ±)
                "resetHour": 0,
                
                // activeDays: Bonusun aktif olduÄŸu gÃ¼nler
                // resetDayCount="activeDays" ise zorunlu
                // [Pzt,Sal,Ã‡ar,Per,Cum,Cmt,Paz]
                // 1: Aktif, 0: Pasif
                "activeDays": [1,1,0,0,0,1,1]

                // availableBonuses: Bonus kullanÄ±mÄ± sÄ±rasÄ±nda kontrol edilicek bonuslar
                // Opsiyonel, null = kontrol yok
                // KullanÄ±labilir bonuslar: [4478, 4479, 4480]
                
                "availableBonuses": [4478, 4479, 4480], // KullanÄ±labilir bonus idleri
            },
            "conditions": {
                // Bonus koÅŸullarÄ±
                // activeBonusCheck: Aktif bonus kontrolÃ¼ yapÄ±lsÄ±n mÄ±?
                "activeBonusCheck": true
            }
        }
    ],
    // KullanÄ±cÄ± bilgileri (userid veya username zorunlu)
    "username": "testUser",    // KullanÄ±cÄ± adÄ± 
    "userid": 123456,         // KullanÄ±cÄ± ID (username varsa opsiyonel)
    
    // loadBonus: Bonus yÃ¼klensin mi?
    // true: Kontroller baÅŸarÄ±lÄ± olursa bonusu yÃ¼kle
    // false: Sadece uygunluk kontrolÃ¼ yap
    "loadBonus": false,
    
    // controlParams: YapÄ±lacak kontroller listesi
    "controlParams": [
        {
            // checkLastDeposit: Son yatÄ±rÄ±m kontrolÃ¼
            "controlName": "checkLastDeposit",
            "params": {
                "days": 1,              // Son kaÃ§ gÃ¼n iÃ§inde
                "min": 100,             // Minimum yatÄ±rÄ±m tutarÄ±
                "max": 1000,            // Maximum yatÄ±rÄ±m tutarÄ± (opsiyonel)
                "checkIsUsed": true,    // Ã–NEMLI: YatÄ±rÄ±mdan sonra herhangi bir CASINO veya SPOR bahsi yapÄ±lmÄ±ÅŸ mÄ± kontrol eder
                                      // true = Bet yapÄ±lmamÄ±ÅŸ olmalÄ± (bonus almak iÃ§in)
                                      // false = Bet kontrolÃ¼ yapma
                "beforeBalanceMin": 3,   // YatÄ±rÄ±m Ã¶ncesi min bakiye
                "beforeBalanceMax": 100,   // YatÄ±rÄ±m Ã¶ncesi max bakiye (opsiyonel)
                "checkFirstDeposit": true, // Ä°lk yatÄ±rÄ±m mÄ± kontrolÃ¼ (opsiyonel)
                "checkSecondDeposit": false // Ä°kinci yatÄ±rÄ±m mÄ± kontrolÃ¼ (opsiyonel)
            }
        },
        {
            // checkCurrentBalance: Mevcut bakiye kontrolÃ¼
            "controlName": "checkCurrentBalance", 
            "params": {
                "max": 3,  // Maximum mevcut bakiye
                "min": 1   // Minimum mevcut bakiye (opsiyonel)
            }
        },
        {
            // checkWithdrawExist: Ã‡ekim kontrolÃ¼
            "controlName": "checkWithdrawExist",
            "params": {
                "days": 1,                // Son kaÃ§ gÃ¼n iÃ§inde
                "hasWithdraw": false,     // Ã‡ekim olmamalÄ±
                "controlAfterDeposit": true, // Son yatÄ±rÄ±mdan sonraki Ã§ekimler
                "controlMinDepositDiff": 20,  // Min yatÄ±rÄ±m tutarÄ± kontrolÃ¼
                "controlHourCount": 24     // Son x saat iÃ§inde
            }
        },
        {
            // checkPendingBet: SADECE aÃ§Ä±k/bekleyen bahis kontrolÃ¼
            "controlName": "checkPendingBet",
            "params": {
                "days": 1,     // Son kaÃ§ gÃ¼n iÃ§inde
                "hasBet": false // AÃ§Ä±k bahis olmamalÄ±
            }
        },
        {
            // checkActiveBonusExist: Aktif bonus kontrolÃ¼
            "controlName": "checkActiveBonusExist",
            "params": {
                "hasActiveBonus": false // Aktif bonus olmamalÄ±
            }
        },
        {
            // checkLastDepositMethod: YatÄ±rÄ±m yÃ¶ntemi kontrolÃ¼
            "controlName": "checkLastDepositMethod",
            "params": {
                "depositMethod": ["BigPayssBankTransfer", "Paym"], // Ä°zin verilen yÃ¶ntemler
                "hasMethod": true // true: Bu yÃ¶ntemde olmalÄ±, false: Bu yÃ¶ntemde olmamalÄ±
            }
        },
        {
            // checkDepositCount: Toplam yatÄ±rÄ±m sayÄ±sÄ± kontrolÃ¼  
            "controlName": "checkDepositCount",
            "params": {
                "max": 1,  // Maksimum yatÄ±rÄ±m sayÄ±sÄ±
                "min": 1   // Minimum yatÄ±rÄ±m sayÄ±sÄ±
            }
        },
        {
            // checkDepositExist: YatÄ±rÄ±m varlÄ±ÄŸÄ± kontrolÃ¼
            "controlName": "checkDepositExist",
            "params": {
                "days": 1,           // Son kaÃ§ gÃ¼n iÃ§inde
                "hasDeposit": true   // YatÄ±rÄ±m olmalÄ± mÄ±?
            }
        },
        {
            // checkWithdrawCount: Ã‡ekim sayÄ±sÄ± kontrolÃ¼
            "controlName": "checkWithdrawCount",
            "params": {
                "max": 5,  // Maksimum Ã§ekim sayÄ±sÄ±
                "min": 1   // Minimum Ã§ekim sayÄ±sÄ±
            }
        },
        {
            // checkUserRegister: KullanÄ±cÄ± kayÄ±t tarihi kontrolÃ¼
            "controlName": "checkUserRegister",
            "params": {
                "days": 30  // Son kaÃ§ gÃ¼n iÃ§inde kayÄ±t olmuÅŸ olmalÄ±
            }
        },
        {
            // checkTimeRange: Zaman aralÄ±ÄŸÄ± kontrolÃ¼
            "controlName": "checkTimeRange",
            "params": {
                "startHour": 14, // BaÅŸlangÄ±Ã§ saati (0-23)
                "endHour": 20    // BitiÅŸ saati (0-23)
            }
        },
        {
            // checkBalanceProfit: Bakiye kar/zarar kontrolÃ¼
            "controlName": "checkBalanceProfit",
            "params": {
                "isProfit": false,    // false: Zarar kontrolÃ¼, true: Kar kontrolÃ¼
                "maxDiff": 1000,     // Maksimum fark
                "minDiff": 100       // Minimum fark
            }
        },
        {
            // checkProfitControlDetailed: DetaylÄ± kar/zarar kontrolÃ¼
            "controlName": "checkProfitControlDetailed",
            "params": {
                "days": 1,
                "controlLastDepositBefore": false,
                "calculationFirstDepositAfterHourCount": 24,
                "calculationFirstDepositAfterHourRange": [0, 24],
                "isDepositFilter": true,
                "minDiff": 100,
                "maxDiff": 1000,
                "isProfit": false
            }
        },
        {
            // checkYesterdayTotalDeposit: DÃ¼nkÃ¼ toplam yatÄ±rÄ±m kontrolÃ¼ (YENÄ°)
            "controlName": "checkYesterdayTotalDeposit",
            "params": {
                "min": 1000,  // DÃ¼nkÃ¼ toplam yatÄ±rÄ±m minimum tutarÄ±
                "max": 50000  // DÃ¼nkÃ¼ toplam yatÄ±rÄ±m maksimum tutarÄ± (opsiyonel)
            }
        },
        {
            // checkIpConflict: IP Ã§akÄ±ÅŸma kontrolÃ¼
            "controlName": "checkIpConflict",
            "params": {}  // Parametre gerektirmez
        }
    ]
}
                </code></pre>
            </div>
        </section>

        <section id="important-notes">
            <h2>ğŸš¨ Ã–NEMLÄ° NOTLAR VE DÃœZELTMELER</h2>
            
            <div class="feature-card">
                <h3>checkIsUsed Parametresi - DÃœZELTME</h3>
                <p><strong>YANLIÅ DOKÃœMANTASYON DÃœZELTILDI:</strong></p>
                <p><code>checkIsUsed: true</code> parametresi "yatÄ±rÄ±mÄ±n baÅŸka bonusta kullanÄ±lÄ±p kullanÄ±lmadÄ±ÄŸÄ±nÄ±" kontrol ETMÄ°YOR!</p>
                
                <div class="notes">
                    <h4>GerÃ§ek Ä°ÅŸlev:</h4>
                    <ul>
                        <li><strong>checkIsUsed: true</strong> = YatÄ±rÄ±mdan sonra herhangi bir CASINO veya SPOR bahsi yapÄ±lmÄ±ÅŸ mÄ± kontrol eder</li>
                        <li>EÄŸer yatÄ±rÄ±mdan sonra bet yapÄ±lmÄ±ÅŸsa: <code>CASINO_BET_AFTER_DEPOSIT</code> veya <code>SPORT_BET_AFTER_DEPOSIT</code> hatasÄ± dÃ¶ner</li>
                        <li>Bu parametre oyuncunun bonus almadan Ã¶nce oynamaya baÅŸlamamÄ±ÅŸ olmasÄ±nÄ± garantiler</li>
                        <li><strong>checkIsUsed: false</strong> = Bu kontrol yapÄ±lmaz</li>
                    </ul>
                </div>
            </div>

            <div class="feature-card">
                <h3>checkPendingBet vs checkIsUsed FarkÄ±</h3>
                <div class="notes">
                    <ul>
                        <li><strong>checkPendingBet</strong>: SADECE aÃ§Ä±k/bekleyen bahisleri kontrol eder</li>
                        <li><strong>checkIsUsed</strong>: Son yatÄ±rÄ±mdan sonra yapÄ±lan TÃœM bahisleri (kazanmÄ±ÅŸ, kaybetmiÅŸ, aÃ§Ä±k) kontrol eder</li>
                        <li>Bonus almadan Ã¶nce oynamamÄ±ÅŸ olma kontrolÃ¼ iÃ§in: <code>checkIsUsed: true</code> kullanÄ±n</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="bonus-variations">
            <h2>Bonus TÃ¼rleri ve Ã–rnekler</h2>
            {% for key, variation in bonus_variations.items() %}
            <div class="variation-card">
                <h3>{{ variation.title }}</h3>
                <p>{{ variation.description | replace('\n', '<br>') | safe }}</p>
                
                {% if variation.notes %}
                <div class="notes">
                    <h4>Ã–nemli Notlar:</h4>
                    <ul>
                    {% for note in variation.notes %}
                        <li>{{ note }}</li>
                    {% endfor %}
                    </ul>
                </div>
                {% endif %}

                <div class="parameters">
                    <h4>Parametreler:</h4>
                    {% if variation.parameters %}
                    <ul>
                    {% for param in variation.parameters %}
                        <li><strong>{{ param.name }}</strong>: {{ param.description | replace('\n', '<br>') | safe }}</li>
                    {% endfor %}
                    </ul>
                    {% endif %}
                </div>

                <pre><code class="language-json">{{ variation.example | tojson(indent=2) }}</code></pre>
                
                {% if variation.useCases %}
                <div class="use-cases">
                    <h4>KullanÄ±m SenaryolarÄ±:</h4>
                    <ul>
                    {% for case in variation.useCases %}
                        <li>{{ case }}</li>
                    {% endfor %}
                    </ul>
                </div>
                {% endif %}
            </div>
            {% endfor %}
        </section>

        <section id="multi-bonus-handling">
            <h2>ğŸ¯ Multi-Bonus Sistemi ve Ã‡akÄ±ÅŸma YÃ¶netimi</h2>
            
            <div class="feature-card">
                <h3>Ã–ncelik Sistemi (Priority System)</h3>
                <p>Birden fazla bonus uygun olduÄŸunda hangi bonusun seÃ§ileceÄŸini belirler. YÃ¼ksek Ã¶ncelik deÄŸeri = daha Ã¶nemli bonus.</p>
                
                <div class="example">
                    <h4>Ã–rnek KullanÄ±m:</h4>
                    <pre><code class="language-json">
{
    "bonuses": [
        {
            "id": 24095,
            "priority": 20,  // En yÃ¼ksek Ã¶ncelik
            "value": {...}
        },
        {
            "id": 24096, 
            "priority": 15,  // DÃ¼ÅŸÃ¼k Ã¶ncelik
            "value": {...}
        }
    ]
}
                    </code></pre>
                </div>
                
                <div class="notes">
                    <h4>Ã–ncelik Seviyeleri:</h4>
                    <ul>
                        <li><strong>20-25:</strong> Kritik bonuslar (kayÄ±p telafisi, VIP)</li>
                        <li><strong>15-19:</strong> YÃ¼ksek deÄŸer (hoÅŸgeldin, ilk yatÄ±rÄ±m)</li>
                        <li><strong>10-14:</strong> Orta seviye (gÃ¼nlÃ¼k, haftalÄ±k)</li>
                        <li><strong>5-9:</strong> DÃ¼ÅŸÃ¼k deÄŸer (freespin, kÃ¼Ã§Ã¼k Ã¶dÃ¼ller)</li>
                        <li><strong>0:</strong> VarsayÄ±lan (Ã¶ncelik belirtilmemiÅŸ)</li>
                    </ul>
                </div>
            </div>

            <div class="feature-card">
                <h3>Bonus GruplarÄ± (Bonus Groups)</h3>
                <p>AynÄ± gruptan sadece bir bonus alÄ±nabilir. Grup iÃ§indeki en yÃ¼ksek Ã¶ncelikli bonus seÃ§ilir.</p>
                
                <div class="example">
                    <h4>Ã–rnek:</h4>
                    <pre><code class="language-json">
{
    "bonuses": [
        {
            "id": 24095,
            "priority": 20,
            "bonusGroup": "dailyDeposit",  // AynÄ± grup
            "value": {...}
        },
        {
            "id": 24096,
            "priority": 15,
            "bonusGroup": "dailyDeposit",  // AynÄ± grup - sadece 24095 seÃ§ilir
            "value": {...}
        }
    ]
}
                    </code></pre>
                </div>
            </div>

            <div class="feature-card">
                <h3>KarÅŸÄ±lÄ±klÄ± DÄ±ÅŸlama (Mutual Exclusion)</h3>
                <p>Belirli bonuslarÄ±n birlikte alÄ±namayacaÄŸÄ±nÄ± tanÄ±mlar.</p>
                
                <div class="example">
                    <h4>Ã–rnek:</h4>
                    <pre><code class="language-json">
{
    "bonuses": [
        {
            "id": 24095,
            "priority": 20,
            "mutuallyExclusive": [24096, 24097],  // Bu bonuslarla birleÅŸtirilemez
            "value": {...}
        }
    ]
}
                    </code></pre>
                </div>
            </div>

            <div class="feature-card">
                <h3>Bonus BaÄŸÄ±mlÄ±lÄ±klarÄ± (Dependencies)</h3>
                <p>BazÄ± bonuslar iÃ§in Ã¶nce baÅŸka bonuslarÄ±n alÄ±nmasÄ± gerekir.</p>
                
                <div class="example">
                    <h4>Ã–rnek:</h4>
                    <pre><code class="language-json">
{
    "bonuses": [
        {
            "id": 24097,
            "priority": 15,
            "requiredBonuses": [24098],  // Ã–nce 24098 bonusu alÄ±nmalÄ±
            "value": {...}
        }
    ]
}
                    </code></pre>
                </div>
            </div>
        </section>

        <section id="deposit-timing">
            <h2>ğŸ“… YatÄ±rÄ±m ZamanlamasÄ± Kontrolleri</h2>
            
            <div class="feature-card">
                <h3>GÃ¼nÃ¼n Ä°lk YatÄ±rÄ±mÄ± Bonusu</h3>
                <p>KullanÄ±cÄ±nÄ±n o gÃ¼n yaptÄ±ÄŸÄ± ilk yatÄ±rÄ±m iÃ§in bonus verir.</p>
                
                <div class="example">
                    <h4>Kontrol Parametreleri:</h4>
                    <pre><code class="language-json">
{
    "controlParams": [
        {
            "controlName": "checkLastDeposit",
            "params": {
                "days": 1,
                "checkFirstDeposit": false,   // Ä°lk yatÄ±rÄ±m kontrolÃ¼ kapalÄ±
                "checkSecondDeposit": false,  // Ä°kinci yatÄ±rÄ±m kontrolÃ¼ kapalÄ±
                "checkIsUsed": false          // KullanÄ±m kontrolÃ¼ kapalÄ±
            }
        }
    ],
    "bonuses": [
        {
            "usage": {
                "maxUses": 1,
                "resetDayCount": 1,  // GÃ¼nlÃ¼k sÄ±fÄ±rlama
                "resetHour": 0
            }
        }
    ]
}
                    </code></pre>
                </div>
            </div>

            <div class="feature-card">
                <h3>GÃ¼nÃ¼n Ä°kinci YatÄ±rÄ±mÄ± Bonusu</h3>
                <p>KullanÄ±cÄ±nÄ±n o gÃ¼n yaptÄ±ÄŸÄ± tam olarak ikinci yatÄ±rÄ±m iÃ§in bonus verir.</p>
                
                <div class="example">
                    <h4>Kontrol Parametreleri:</h4>
                    <pre><code class="language-json">
{
    "controlParams": [
        {
            "controlName": "checkLastDeposit",
            "params": {
                "days": 1,
                "checkFirstDeposit": false,
                "checkSecondDeposit": true,   // Ä°kinci yatÄ±rÄ±m kontrolÃ¼ aktif
                "checkIsUsed": false
            }
        },
        {
            "controlName": "checkDepositCount",
            "params": {
                "min": 2  // En az 2 yatÄ±rÄ±m olmalÄ±
            }
        }
    ]
}
                    </code></pre>
                </div>
                
                <div class="notes">
                    <h4>Ä°kinci YatÄ±rÄ±m Kontrol MantÄ±ÄŸÄ±:</h4>
                    <ul>
                        <li>O gÃ¼n tam olarak 2 yatÄ±rÄ±m yapÄ±lmÄ±ÅŸ olmalÄ±</li>
                        <li>Mevcut yatÄ±rÄ±m gÃ¼nÃ¼n 2. yatÄ±rÄ±mÄ± olmalÄ±</li>
                        <li>2'den fazla yatÄ±rÄ±m varsa bonus verilmez</li>
                    </ul>
                </div>
            </div>

            <div class="feature-card">
                <h3>YaÅŸam Boyu Ä°lk YatÄ±rÄ±m (HoÅŸgeldin) Bonusu</h3>
                <p>KullanÄ±cÄ±nÄ±n hiÃ§ yatÄ±rÄ±m yapmadÄ±ÄŸÄ± durumda verilen tek seferlik bonus.</p>
                
                <div class="example">
                    <h4>Kontrol Parametreleri:</h4>
                    <pre><code class="language-json">
{
    "controlParams": [
        {
            "controlName": "checkLastDeposit",
            "params": {
                "days": 1,
                "checkFirstDeposit": true,    // Ä°lk yatÄ±rÄ±m kontrolÃ¼ aktif
                "checkSecondDeposit": false,
                "checkIsUsed": false
            }
        },
        {
            "controlName": "checkDepositCount",
            "params": {
                "max": 1  // Maksimum 1 yatÄ±rÄ±m olmalÄ±
            }
        }
    ],
    "bonuses": [
        {
            "usage": {
                "maxUses": 1,
                "resetDayCount": -1  // HiÃ§ sÄ±fÄ±rlanmaz
            }
        }
    ]
}
                    </code></pre>
                </div>
            </div>
        </section>

        <section id="yesterday-deposit-bonus">
            <h2>ğŸ“… DÃ¼nkÃ¼ Toplam YatÄ±rÄ±m Bonusu (YENÄ° Ã–ZELLÄ°K)</h2>
            
            <div class="feature-card">
                <h3>yesterdayTotalDeposit Hesaplama TÃ¼rÃ¼</h3>
                <p>KullanÄ±cÄ±nÄ±n dÃ¼n yaptÄ±ÄŸÄ± tÃ¼m yatÄ±rÄ±mlarÄ±n toplamÄ± Ã¼zerinden bonus hesaplar. Son yatÄ±rÄ±m yerine gÃ¼nÃ¼n tÃ¼m yatÄ±rÄ±mlarÄ±nÄ± dikkate alÄ±r.</p>
                
                <div class="notes">
                    <h4>Ã–nemli Ã–zellikler:</h4>
                    <ul>
                        <li><strong>Timezone Aware:</strong> KullanÄ±cÄ±nÄ±n gerÃ§ek zamanÄ±nÄ± dikkate alÄ±r</li>
                        <li><strong>Toplam Hesaplama:</strong> DÃ¼nkÃ¼ tÃ¼m yatÄ±rÄ±mlarÄ±n toplamÄ±nÄ± alÄ±r</li>
                        <li><strong>DetaylÄ± Logging:</strong> Her yatÄ±rÄ±m detayÄ±nÄ± loglar</li>
                        <li><strong>Saat AralÄ±ÄŸÄ±:</strong> DÃ¼n 00:00 - 23:59 arasÄ± tÃ¼m yatÄ±rÄ±mlar</li>
                    </ul>
                </div>
            </div>

            <div class="feature-card">
                <h3>GÃ¼nlÃ¼k Toplam YatÄ±rÄ±m Bonusu</h3>
                <p>DÃ¼n toplam 1000+ TL yatÄ±rÄ±m yapan oyuncular iÃ§in kademeli FreeSpin bonusu.</p>
                
                <div class="example">
                    <h4>Tam Ã–rnek - FreeSpin Bonusu:</h4>
                    <pre><code class="language-json">
{
    "bonuses": [
        {
            "id": 24105,
            "priority": 20,
            "bonusGroup": "yesterdayDeposit",
            "value": {
                "calculationType": "fixed",
                "amountCalculation": "yesterdayTotalDeposit",
                "amount": [
                    {
                        "min": 1000,
                        "max": 3000,
                        "percentage": 30  // 30 FreeSpin
                    },
                    {
                        "min": 3001,
                        "max": 7500,
                        "percentage": 50  // 50 FreeSpin
                    },
                    {
                        "min": 7501,
                        "max": 12500,
                        "percentage": 75  // 75 FreeSpin
                    },
                    {
                        "min": 12501,
                        "max": 25000,
                        "percentage": 150  // 150 FreeSpin
                    },
                    {
                        "min": 25001,
                        "max": 50000,
                        "percentage": 300  // 300 FreeSpin
                    },
                    {
                        "min": 50001,
                        "max": null,
                        "percentage": 300  // 300 FreeSpin (maksimum)
                    }
                ]
            },
            "usage": {
                "maxUses": 1,
                "resetDayCount": 1  // GÃ¼nlÃ¼k 1 kez
            },
            "conditions": {
                "activeBonusCheck": true
            }
        }
    ],
    "controlParams": [
        {
            "controlName": "checkYesterdayTotalDeposit",
            "params": {
                "min": 1000  // Minimum 1000 TL toplam yatÄ±rÄ±m
            }
        },
        {
            "controlName": "checkTimeRange",
            "params": {
                "startHour": 0,  // Gece yarÄ±sÄ±ndan
                "endHour": 3     // Sabah 03:00'e kadar talep edilebilir
            }
        },
        {
            "controlName": "checkActiveBonusExist",
            "params": {
                "hasActiveBonus": false
            }
        },
        {
            "controlName": "checkLastDeposit",
            "params": {
                "days": 1,
                "checkIsUsed": false  // Bonus almadan Ã¶nce oynamamÄ±ÅŸ olma ÅŸartÄ± yok
            }
        }
    ]
}
                    </code></pre>
                </div>
                
                <div class="notes">
                    <h4>Ã–rnek Senaryo:</h4>
                    <ul>
                        <li><strong>Oyuncu dÃ¼n yaptÄ±ÄŸÄ± yatÄ±rÄ±mlar:</strong> 2000 TL + 1500 TL + 2500 TL = 6000 TL</li>
                        <li><strong>lastDeposit:</strong> Sadece 2500 TL'yi hesaplar â†’ 30 FS</li>
                        <li><strong>yesterdayTotalDeposit:</strong> TÃ¼m 6000 TL'yi hesaplar â†’ 50 FS</li>
                        <li><strong>Bonus talep:</strong> Ertesi gÃ¼n 00:00-03:00 arasÄ± canlÄ± destekten</li>
                    </ul>
                </div>
            </div>

            <div class="feature-card">
                <h3>checkYesterdayTotalDeposit Kontrol Fonksiyonu</h3>
                <p>DÃ¼nkÃ¼ toplam yatÄ±rÄ±m miktarÄ±nÄ± kontrol eden yeni kontrol fonksiyonu.</p>
                
                <div class="example">
                    <h4>Kontrol Parametreleri:</h4>
                    <pre><code class="language-json">
{
    "controlName": "checkYesterdayTotalDeposit",
    "params": {
        "min": 1000,    // Minimum toplam yatÄ±rÄ±m (zorunlu deÄŸil)
        "max": 100000   // Maksimum toplam yatÄ±rÄ±m (opsiyonel)
    }
}
                    </code></pre>
                </div>

                <div class="notes">
                    <h4>Kontrol MantÄ±ÄŸÄ±:</h4>
                    <ul>
                        <li>KullanÄ±cÄ±nÄ±n gerÃ§ek zamanÄ±na gÃ¶re dÃ¼nÃ¼ hesaplar</li>
                        <li>Sadece onaylanmÄ±ÅŸ yatÄ±rÄ±mlarÄ± (Status=8) dikkate alÄ±r</li>
                        <li>Timezone farkÄ±nÄ± otomatik hesaplar</li>
                        <li>Her yatÄ±rÄ±mÄ±n detayÄ±nÄ± loglara yazar</li>
                    </ul>
                </div>
            </div>

            <div class="feature-card">
                <h3>Loglardan Takip</h3>
                <p>yesterdayTotalDeposit kullanÄ±ldÄ±ÄŸÄ±nda aÅŸaÄŸÄ±daki loglarÄ± gÃ¶receksiniz:</p>
                
                <div class="example">
                    <pre><code class="language-text">
Bonus Amount Control - ID: 24105, Type: fixed, Calculation: yesterdayTotalDeposit
Using yesterdayTotalDeposit calculation
Yesterday's Total Deposits: 6000 TL from 2 deposits
Deposit 1: 2000 TL at 2025-07-19T20:48:23 (ID: 216783936)
Deposit 2: 4000 TL at 2025-07-19T21:43:15 (ID: 216783937)
Found matching range: 3001-7500 for amount 6000
                    </code></pre>
                </div>
            </div>
        </section>

        <section id="loss-bonus-advanced">
            <h2>ğŸ’° GeliÅŸmiÅŸ KayÄ±p Bonusu Sistemi</h2>
            
            <div class="feature-card">
                <h3>GÃ¼nlÃ¼k KayÄ±p Bonusu</h3>
                <p>Son 24 saatteki net kayÄ±p Ã¼zerinden hesaplanan bonus.</p>
                
                <div class="example">
                    <h4>Tam Ã–rnek:</h4>
                    <pre><code class="language-json">
{
    "bonuses": [
        {
            "id": 24031,
            "value": {
                "calculationType": "percentage",
                "amountCalculation": "loss",
                "amount": [
                    {
                        "min": 100,
                        "max": 9999,
                        "percentage": 20
                    },
                    {
                        "min": 10000,
                        "max": 19999,
                        "percentage": 25
                    },
                    {
                        "min": 20000,
                        "max": null,
                        "percentage": 30
                    }
                ],
                "minDiff": 100,  // Minimum 100 TL kayÄ±p
                "maxDiff": null
            },
            "usage": {
                "maxUses": -1,
                "resetDayCount": 1,
                "resetHour": 0
            }
        }
    ],
    "controlParams": [
        {
            "controlName": "checkCurrentBalance",
            "params": {
                "max": 1  // Bakiye 1 TL'den az olmalÄ±
            }
        },
        {
            "controlName": "checkLastDeposit",
            "params": {
                "days": 30,  // Son 30 gÃ¼ndeki yatÄ±rÄ±mlarÄ± kontrol et
                "min": 100,
                "checkIsUsed": false
            }
        }
    ]
}
                    </code></pre>
                </div>
            </div>

            <div class="feature-card">
                <h3>AylÄ±k KayÄ±p Bonusu</h3>
                <p>Son 30 gÃ¼ndeki toplam net kayÄ±p Ã¼zerinden hesaplanan bÃ¼yÃ¼k bonus.</p>
                
                <div class="example">
                    <h4>Tam Ã–rnek:</h4>
                    <pre><code class="language-json">
{
    "bonuses": [
        {
            "id": 24108,
            "value": {
                "calculationType": "percentage",
                "amountCalculation": "loss",
                "amount": [
                    {
                        "min": 25000,
                        "max": null,
                        "percentage": 5
                    }
                ],
                "minDiff": 25000,  // Minimum 25,000 TL kayÄ±p
                "max": 10000       // Maksimum 10,000 TL bonus
            },
            "usage": {
                "maxUses": 1,
                "resetDayCount": 30,  // AylÄ±k sÄ±fÄ±rlama
                "resetHour": 0
            }
        }
    ],
    "controlParams": [
        {
            "controlName": "checkCurrentBalance",
            "params": {
                "max": 100
            }
        },
        {
            "controlName": "checkActiveBonusExist",
            "params": {
                "hasActiveBonus": false
            }
        }
    ]
}
                    </code></pre>
                </div>
                
                <div class="notes">
                    <h4>AylÄ±k KayÄ±p Bonusu Ã–zellikleri:</h4>
                    <ul>
                        <li>Son 30 gÃ¼ndeki tÃ¼m yatÄ±rÄ±m-Ã§ekim hesaplanÄ±r</li>
                        <li>Minimum 25,000 TL net kayÄ±p ÅŸartÄ±</li>
                        <li>%5 oranÄ±nda bonus verilir</li>
                        <li>Maksimum 10,000 TL bonus limiti</li>
                        <li>Ayda bir kez alÄ±nabilir</li>
                        <li>CanlÄ± destek Ã¼zerinden talep edilir</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="advanced-features">
            <h2>ğŸš€ GeliÅŸmiÅŸ Ã–zellikler</h2>
            
            <div class="feature-card">
                <h3>Kademeli Bonus Sistemi</h3>
                <p>YatÄ±rÄ±m miktarÄ±na gÃ¶re farklÄ± bonus oranlarÄ±.</p>
                
                <div class="example">
                    <pre><code class="language-json">
{
    "value": {
        "calculationType": "fixed",
        "amountCalculation": "lastDeposit",
        "amount": [
            {"min": 1000, "max": 2499, "percentage": 10},
            {"min": 2500, "max": 4999, "percentage": 25},
            {"min": 5000, "max": 9999, "percentage": 30},
            {"min": 10000, "max": null, "percentage": 50}
        ]
    }
}
                    </code></pre>
                </div>
            </div>

            <div class="feature-card">
                <h3>Bonus Filtreleme</h3>
                <p>Ã–nceki bonuslarÄ± hesaplamaya dahil etmeme veya sadece belirli bonuslarÄ± dahil etme.</p>
                
                <div class="example">
                    <pre><code class="language-json">
{
    "value": {
        "FilterAllowedBonusses": [24031, 24095],  // Sadece bu bonuslar dahil
        "FilterReverse": true  // true: Sadece listedekiler, false: Listedekiler hariÃ§
    }
}
                    </code></pre>
                </div>
            </div>

            <div class="feature-card">
                <h3>Zaman AralÄ±ÄŸÄ± KontrolÃ¼</h3>
                <p>Bonusun sadece belirli saatlerde alÄ±nabilmesi.</p>
                
                <div class="example">
                    <pre><code class="language-json">
{
    "controlParams": [
        {
            "controlName": "checkTimeRange",
            "params": {
                "startHour": 14,  // 14:00'dan itibaren
                "endHour": 20     // 20:00'e kadar
            }
        }
    ]
}
                    </code></pre>
                </div>
            </div>
        </section>

        <section id="usage-examples">
            <h2>KullanÄ±m Ã–rnekleri</h2>
            {% for key, example in usage_examples.items() %}
            <div class="example-card">
                <h3>{{ example.title }}</h3>
                <p>{{ example.description | replace('\n', '<br>') | safe }}</p>
                
                {% if example.notes %}
                <div class="notes">
                    <h4>Ã–nemli Notlar:</h4>
                    <ul>
                    {% for note in example.notes %}
                        <li>{{ note }}</li>
                    {% endfor %}
                    </ul>
                </div>
                {% endif %}

                <pre><code class="language-json">{{ example.example | tojson(indent=2) }}</code></pre>
            </div>
            {% endfor %}
        </section>

        <section id="controls">
            <h2>Mevcut Kontroller</h2>
            {% for name, control in controls.items() %}
            <div class="control-card">
                <h3>{{ name }}</h3>
                <p>{{ control.description | replace('\n', '<br>') | safe }}</p>
                
                {% if control.parameters %}
                <h4>Parametreler:</h4>
                <table>
                    <tr>
                        <th>Ä°sim</th>
                        <th>Tip</th>
                        <th>Zorunlu</th>
                        <th>VarsayÄ±lan</th>
                        <th>AÃ§Ä±klama</th>
                    </tr>
                    {% for param in control.parameters %}
                    <tr>
                        <td>{{ param.name }}</td>
                        <td>{{ param.type }}</td>
                        <td>{{ "Evet" if param.required else "HayÄ±r" }}</td>
                        <td>{{ param.default if param.default != None else "-" }}</td>
                        <td>{{ param.description | replace('\n', '<br>') | safe if param.description }}</td>
                    </tr>
                    {% endfor %}
                </table>
                {% endif %}

                {% if control.examples %}
                <div class="examples">
                    <h4>Ã–rnek KullanÄ±mlar:</h4>
                    {% for example in control.examples %}
                    <div class="example">
                        <h5>{{ example.title }}</h5>
                        <pre><code class="language-json">{{ example.code | tojson(indent=2) }}</code></pre>
                        <p>{{ example.description | replace('\n', '<br>') | safe }}</p>
                    </div>
                    {% endfor %}
                </div>
                {% endif %}
            </div>
            {% endfor %}
        </section>
        
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            hljs.highlightAll();
        });
    </script>
</body>
</html>
